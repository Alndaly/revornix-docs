import { Callout } from 'nextra/components';

# 三方 API

这篇文档讲解的是所有可公开的 API 接口。所有请求以`/tp`开头。

**该页面所有接口请求时必须携带如下请求头**

| 请求头  | 值           |
| ------- | ------------ |
| API-KEY | your api key |

APIKEY 可以通过点击 **Revornix 系统内左下角头像**->**账户**->**APIKey 管理** 增加。

---

### `/tp/file/upload`

上传文件

#### 参数

| 参数名       | 类型   | 必填 | 描述     |
| ------------ | ------ | ---- | -------- |
| file         | File   | 是   | 文件     |
| file_path    | string | 否   | 文件路径 |
| content_type | string | 否   | 文件类型 |

#### 示例代码

```python
import httpx
client = httpx.Client()
headers = {
    "API-KEY": "your api key"
}
files = {
    "file": ("example.md", open("example.md", "rb"), "text/markdown")
}
data = {
    "file_path": "/files/example.md",
    "content_type": "text/markdown"
}
response = client.post(
    url="http://localhost:8001/tp/section/create",
    headers=headers,
    files=files,
    data=data
)

```

---

### `/tp/section/create`

创建专栏

#### 参数

| 参数名                         | 类型   | 必填 | 描述                                        |
| ------------------------------ | ------ | ---- | ------------------------------------------- |
| title                          | string | 是   | 专栏名                                      |
| description                    | string | 是   | 专栏描述                                    |
| cover                          | string | 否   | 封面图片                                    |
| labels                         | int[]  | 是   | 标签组                                      |
| auto_publish                   | bool   | 否   | 是否自动发布                                |
| auto_podcast                   | bool   | 否   | 是否自动生成音频播客                        |
| auto_illustration              | bool   | 否   | 是否自动生成插图                            |
| process_task_trigger_type      | int    | 是   | 进程触发原因（0: 时间触发/1: 更新事件触发） |
| process_task_trigger_scheduler | bool   | 否   | 时间触发原因下的具体触发时间（cron 表达式） |

#### 示例代码

```python
import httpx
client = httpx.Client()
headers = {
    "API-KEY": "your api key"
}
response = client.post(
    url="http://localhost:8001/tp/section/create",
    headers=headers,
    json={
        "title": "test title",
        "description": "test description",
        "cover": "test/test.png",
        "labels": [1, 2],
        "auto_publish": true,
        "process_task_trigger_type": 1
    }
)
```

### `/tp/section/label/create`

创建专栏标签

#### 参数

| 参数名 | 类型   | 必填 | 描述   |
| ------ | ------ | ---- | ------ |
| name   | string | 是   | 标签名 |

#### 示例代码

```python
import httpx
client = httpx.Client()
headers = {
    "API-KEY": "your api key"
}
response = client.post(
    url="http://localhost:8001/tp/section/label/create",
    headers=headers,
    json={
        "name": "test"
    }
)
```

---

### `/tp/section/mine/all`

获取我的所有专栏

---

### `/tp/document/label/list`

获取所有文档标签

---

### `/tp/document/label/create`

创建文档标签

#### 参数

| 参数名 | 类型   | 必填 | 描述   |
| ------ | ------ | ---- | ------ |
| name   | string | 是   | 标签名 |

#### 示例代码

```python
import httpx
client = httpx.Client()
headers = {
    "API-KEY": "your api key"
}
response = client.post(
    url="http://localhost:8001/tp/document/label/create",
    headers=headers,
    json={
        "name": "test"
    }
)
```

---

### `/tp/document/create`

创建文档

#### 参数

| 参数名       | 类型    | 必填  | 描述                                                                                                                                    |
| ------------ | ------- | ----- | --------------------------------------------------------------------------------------------------------------------------------------- |
| category     | int     | 是    | 文档类型，0：文件文档，1：链接文档，2：速记文档                                                                                         |
| sections     | int[]   | 是    | 推送专栏组                                                                                                                              |
| labels       | int[]   | 是    | 标签组                                                                                                                                  |
| title        | string  | 否    | 标题                                                                                                                                    |
| description  | string  | 否    | 描述                                                                                                                                    |
| cover        | string  | 否    | 封面                                                                                                                                    |
| content      | string  | 是/否 | 内容，如果是速记文档则必填，且仅在速记文档下有效                                                                                        |
| url          | string  | 是/否 | 链接，如果是链接文档则必填，且仅在链接文档下有效                                                                                        |
| file_name    | string  | 是/否 | 文件路径（本质上就是你上传文件的时候的`file_path`），如果是文件文档则必填，且仅在文件文档下有效，该方式需要你先调用文件上传接口上传文件 |
| auto_summary | boolean | 否    | 是否自动生成摘要                                                                                                                        |
| auto_podcast | boolean | 否    | 是否自动生成播客                                                                                                                        |
| auto_tag     | boolean | 否    | 是否自动打标                                                                                                                            |
| from_plat    | string  | 是    | 来源平台，此处请根据实际情况填写，主观上建议这里填写 `api`                                                                              |

#### 示例代码

本代码仅作链接文档示例，其他类型文档请自行修改。

```python
import httpx
client = httpx.Client()
headers = {
    "API-KEY": "your api key"
}
response = client.post(
    url="http://localhost:8001/tp/document/create",
    headers=headers,
    json={
        "category": 1,
        "url": "https://baidu.com"
        "sections": [],
        "auto_summary": True,
        "labels": [],
        "from_plat": "api",
    }
)
```
